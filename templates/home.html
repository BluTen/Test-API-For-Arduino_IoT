<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta lang="en-IN">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">

    <title>Arduino Control API</title>

</head>

<header>

</header>

<body>
    <h1>Type your sentence</h1>
    <br>
    <span>
        <input value="{{ messages['btext'] }}" type="text" name="Your Sentence" id="TEXT">
    </span>
    <a id="ButtoN" class="button-blue" href="#" onclick="myFunction()">Submit</a>
    <h6 id="footer">Programmed By: <strong>Nayan Shetty</strong></h6>
</body>
<script>
    function myFunction() {
        var input = document.getElementById("TEXT").value

        if (input.length > 16) {
            alert("Sentence can't be more than 16 in length!")
        } else {
            post('/display/post/', {
                "text": input
            })
        }
    }
    document.getElementById("TEXT")
        .addEventListener("keyup", function(event) {
            event.preventDefault();
            if (event.keyCode === 13) {
                document.getElementById("ButtoN").click();
            }
        });

    /**
     * sends a request to the specified url from a form. this will change the window location.
     * @param {string} path the path to send the post request to
     * @param {object} params the paramiters to add to the url
     * @param {string} [method=post] the method to use on the form
     */

    function post(path, params, method = 'post') {

        // The rest of this code assumes you are not using a library.
        // It can be made less wordy if you use one.
        const form = document.createElement('form');
        form.method = method;
        form.action = path;

        for (const key in params) {
            if (params.hasOwnProperty(key)) {
                const hiddenField = document.createElement('input');
                hiddenField.type = 'hidden';
                hiddenField.name = key;
                hiddenField.value = params[key];

                form.appendChild(hiddenField);
            }
        }

        document.body.appendChild(form);
        form.submit();
    }
</script>

</html>